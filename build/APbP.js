apbp={};apbp.version="0.1";apbp.playerIndex=0;(function(e){apbp.legacy={testForFlexbox:function(){var e=document.documentElement.style;if("flexWrap"in e||"WebkitFlexWrap"in e||"msFlexWrap"in e){return true}return false},testForSvg:function(){var e=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect;if(e){return true}return false}};apbp.apbpDefaults={poster:"",showPosterWhenEnded:false,defaultWidth:480,defaultHeight:270,width:-1,height:-1,aspectRatio:"12:9",aspectRatioFullscreen:null,defaultSeekBackwardInterval:function(e){return e.duration*.05},defaultSeekForwardInterval:function(e){return e.duration*.05},setDimensions:true,startVolume:.8,loop:false,autoRewind:true,enableAutosize:true,timeFormat:"",alwaysShowHours:false,showTimecodeFrameCount:false,framesPerSecond:25,autosizeProgress:true,alwaysShowControls:false,clickToPlayPause:true,features:["playpause","current","progress","duration","tracks","volume","fullscreen"],hidableControls:true,enableKeyboard:true,pauseOtherPlayers:true,hideVolumeOnTouchDevices:true,loopPlaylist:false,audioVolume:"horizontal",muteText:mejs.i18n.t("Mute Toggle"),allyVolumeControlText:mejs.i18n.t("Use Up/Down Arrow keys to increase or decrease volume."),playText:mejs.i18n.t("Play"),pauseText:mejs.i18n.t("Pause"),nextText:"Next Track",prevText:"Previous Track",fullscreenText:"Fullscreen",fullscreenTextExit:"Restore",stacking:false,handleFastclick:false,keyActions:[{keys:[32,179],action:function(e,a){if(a.paused||a.ended){a.play()}else{a.pause()}}},{keys:[38],action:function(e,a){e.container.find(".apbp-volume-slider").css("display","block");if(e.hidableControls){e.startControlsTimer()}var t=Math.min(a.volume+.1,1);a.setVolume(t)}},{keys:[40],action:function(e,a){e.container.find(".apbp-volume-slider").css("display","block");if(e.hidableControls){e.startControlsTimer()}var t=Math.max(a.volume-.1,0);a.setVolume(t)}},{keys:[37,227],action:function(e,a){if(!isNaN(a.duration)&&a.duration>0){if(e.hidableControls){e.startControlsTimer()}var t=Math.max(a.currentTime-e.options.defaultSeekBackwardInterval(a),0);a.setCurrentTime(t)}}},{keys:[39,228],action:function(e,a){if(!isNaN(a.duration)&&a.duration>0){if(e.hidableControls){e.startControlsTimer()}var t=Math.min(a.currentTime+e.options.defaultSeekForwardInterval(a),a.duration);a.setCurrentTime(t)}}},{keys:[70],action:function(e,a){if(typeof e.enterFullScreen!="undefined"){if(e.isFullScreen){e.exitFullScreen()}else{e.enterFullScreen()}}}},{keys:[77],action:function(e,a){e.container.find(".apbp-volume-slider").css("display","block");if(e.hidableControls){e.startControlsTimer()}if(e.media.muted){e.setMuted(false)}else{e.setMuted(true)}}}]};apbp.playerIndex=0;apbp.players={};apbp.audioPicturebookPlayer=function(a,t){if(!(this instanceof apbp.audioPicturebookPlayer)){return new apbp.audioPicturebookPlayer(a,t)}if(!apbp.legacy.testForSvg()){return}var i=this;i.$media=i.$node=e(a);i.node=i.media=i.$media[0];if(!i.node){return}if(typeof i.node.player!="undefined"){return i.node.player}if(typeof t=="undefined"){t=i.$node.data("mejsoptions")}i.options=e.extend({},apbp.apbpDefaults,t);if(!i.options.timeFormat){i.options.timeFormat="mm:ss";if(i.options.alwaysShowHours){i.options.timeFormat="hh:mm:ss"}if(i.options.showTimecodeFrameCount){i.options.timeFormat+=":ff"}}mejs.Utility.calculateTimeFormat(0,i.options,i.options.framesPerSecond||25);i.id="apbp_"+apbp.playerIndex++;apbp.players[i.id]=i;i.init();return i};apbp.audioPicturebookPlayer.prototype={hasFocus:false,controlsAreVisible:true,playpausesvg:'<svg xmlns="http://www.w3.org/2000/svg" class="needsclick" viewBox="0 0 512 512"><circle style="fill:#fff;fill-opacity:1;stroke:none;" id="bg" class="needsclick" cx="256" cy="256" r="240" /><path class="play needsclick" d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm115.7 272l-176 101c-15.8 8.8-35.7-2.5-35.7-21V152c0-18.4 19.8-29.8 35.7-21l176 107c16.4 9.2 16.4 32.9 0 42z"/><path class="pause needsclick" d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm-16 328c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h48c8.8 0 16 7.2 16 16v160zm112 0c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h48c8.8 0 16 7.2 16 16v160z"/></svg>',init:function(){var a=this,t=mejs.MediaFeatures;meOptions=e.extend(true,{},a.options,{success:function(e,t){a.apbpReady(e,t)},error:function(e){a.handleError(e)}}),tagName=a.media.tagName.toLowerCase();a.isVideo=false;a.$media.removeAttr("controls");var i=mejs.i18n.t("Audio Player");e('<span class="apbp-offscreen">'+i+"</span>").insertBefore(a.$media);a.container=e('<div id="'+a.id+'" class="apbp-container '+(mejs.MediaFeatures.svgAsImg?"svg":"no-svg")+(apbp.legacy.testForFlexbox()?" flex ":" noFlex ")+" mep-paused"+'" tabindex="0" role="application" aria-label="'+i+'">'+'<div class="apbp-clear"></div>'+'<div class="apbp-inner">'+'<div class="apbp-mediaelement"></div>'+'<div class="apbp-layers">'+'<div class="apbp-poster apbp-layer"></div>'+'<div class="apbp-images apbp-layer"></div>'+'<div class="apbp-paused-overlay apbp-layer">'+'<span class="apbp-overlay-image-button">'+this.playpausesvg+"</span>"+"</div>"+'<div class="apbp-control-overlay apbp-layer">'+'<div class="apbp-control-overlay-left"><span class="apbp-overlay-image-button"></span></div>'+'<div class="apbp-control-overlay-center"><span class="apbp-overlay-image-button">'+this.playpausesvg+"</span></div>"+'<div class="apbp-control-overlay-right"><span class="apbp-overlay-image-button"></span></div>'+"</div>"+"</div>"+'<div class="apbp-controls"></div>'+"</div>"+"</div>").addClass(a.$media[0].className).insertBefore(a.$media).focus(function(e){if(!a.controlsAreVisible){var t=a.container.find(".apbp-playpause-button > button");t.focus()}});a.container.addClass((t.isAndroid?"apbp-android ":"")+(t.isiOS?"apbp-ios ":"")+(t.isiPad?"apbp-ipad ":"")+(t.isiPhone?"apbp-iphone ":""));if(true){var s=a.$media.clone();e(a.container.find(".apbp-mediaelement")).append(s);a.$media.remove();a.$node=a.$media=s;a.node=a.media=s[0]}else{e(a.container.find(".apbp-mediaelement")).append(a.$media)}a.node.player=a;a.controls=a.container.find(".apbp-controls");a.layers=a.container.find(".apbp-layers");meOptions.pluginWidth=a.width;meOptions.pluginHeight=a.height;a.media=mejs.MediaElement(a.$media[0],meOptions);a.calculatePlayerHeight(a.layers);addEvent("resize",window,function(){a.calculatePlayerHeight(a.layers)},true);a.modcontrollayer(a,a.container.find(".apbp-control-overlay"));var n=function r(e){a.resetControlsTimeout(a.controls)};e(a.controls).on("mousemove",n);e(a.controls).on("mousedown",n);if(a.options.features.includes("progress")){a.controls.append('<div class="apbp-progress">'+'<div class="apbp-progress-loaded" />'+'<div class="apbp-progress-current" />'+'<span class="apbp-time-float" style="display: none;">'+'<span class="apbp-time-float-current">00:00</span>'+'<span class="apbp-time-float-corner"></span>'+"</span>"+"</div>")}var l=e('<div class="apbp-control-buttons" />');a.controls.append(l);this.buildprevtrack(this,l,this.layers,this.media);this.buildplaypause(this.player,l,this.layers,this.media);this.buildnexttrack(this,l,this.layers,this.media);l.append('<span class="apbp-controls-timestamp"><span class="apbp-timestamp-current">00:00</span> / <span class="apbp-timestamp-total"></span></span>');l.append('<span class="apbp-controls-spacer"></span>');a.buildvolume(a,l,a.layers,a.$media[0]);a.buildprogressbar(this,a.controls,a.media);this.buildaudiofullscreen(this,l,this.layers,this.media);a.genPlaylist(a,l,a.layers,a.$media[0]);a.loaded=a.controls.find(".apbp-progress-loaded");a.total=a.controls.find(".apbp-progress-current");e(a.media).on("progress",function(e){this.player.updateCurrent();this.player.updateTotal()});e(a.media).on("timeupdate",function(e){a.updateSlides(a.media,a.layers.find(".apbp-images"),e.currentTime);if(a.media.duration-a.media.currentTime<20&&a.media.readyState==4&&a.media.nearEnd!=true){a.media.nearEnd=true;var t=a.preload.querySelector('[src="'+e.currentTarget.src+'"]').nextSibling;while(t&&1!=t.nodeType){t=t.nextSibling}if(t){console.log("Preload next track"+t.src)}}else if(a.media.currentTime<1&&a.media.nearEnd==true){a.media.nearEnd=false}});var o=a.media.parentElement;a.preload=document.createElement("div");a.preload.classList="apbp-preload";e(o).append(a.preload);e(a.media).find("source").each(function(e,t){var i=document.createElement("audio");if(a.media.children[e].src!=undefined){i.src=a.media.children[e].src;i.controls=false;i.preload="metadata";a.preload.appendChild(i)}})},calculatePlayerHeight:function(e){var a=this.options.aspectRatio.split(":");var t=a[1]/a[0];var i=e.width()*t;this.controls.removeClass("apbp-vanishing");this.controls.removeClass("apbp-vanishing-visible");this.controlsAreVisible=true;e.removeClass("hide-apbp-layers");if(i==0){e.addClass("hide-apbp-layers")}else if(this.isFullScreen){if(this.options.aspectRatioFullscreen){a=this.options.aspectRatioFullscreen.split(":");t=a[1]/a[0];i=e.width()*t}e.height("");if(window.innerHeight-this.controls.height()>i){e.height(window.innerHeight-this.controls.height())}else{e.height("100%");this.controls.addClass("apbp-vanishing");this.resetControlsTimeout(this.controls)}}else{e.height(e.width()*t)}if(e.parent().width()<320){e.parent().removeClass("apbp-small");e.parent().addClass("apbp-tiny")}else if(e.parent().width()<500){e.parent().removeClass("apbp-tiny");e.parent().addClass("apbp-small")}else{e.parent().removeClass("apbp-tiny");e.parent().removeClass("apbp-small")}},setPlayerHeight:function(e,a){if(!this.options.setDimensions){return false}if(typeof a!="undefined"){e.height=a}},buildvolume:function(a,t,i,s){if((mejs.MediaFeatures.isAndroid||mejs.MediaFeatures.isiOS)&&this.options.hideVolumeOnTouchDevices)return;var n=this,l=n.options.audioVolume,o=l=="horizontal"?e('<span class="apbp-button apbp-volume-button apbp-mute">'+'<button type="button" aria-controls="'+n.id+'" title="'+n.options.muteText+'" aria-label="'+n.options.muteText+'"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M256 88.017v335.964c0 21.438-25.943 31.998-40.971 16.971L126.059 352H24c-13.255 0-24-10.745-24-24V184c0-13.255 10.745-24 24-24h102.059l88.971-88.954c15.01-15.01 40.97-4.49 40.97 16.971z"/><path class="sound-waves" d="M438.056 10.141C422.982.92 403.283 5.668 394.061 20.745c-9.221 15.077-4.473 34.774 10.604 43.995C468.967 104.063 512 174.983 512 256c0 73.431-36.077 142.292-96.507 184.206-14.522 10.072-18.129 30.01-8.057 44.532 10.076 14.528 30.016 18.126 44.531 8.057C529.633 438.927 576 350.406 576 256c0-103.244-54.579-194.877-137.944-245.859zM480 256c0-68.547-36.15-129.777-91.957-163.901-15.076-9.22-34.774-4.471-43.994 10.607-9.22 15.078-4.471 34.774 10.607 43.994C393.067 170.188 416 211.048 416 256c0 41.964-20.62 81.319-55.158 105.276-14.521 10.073-18.128 30.01-8.056 44.532 6.216 8.96 16.185 13.765 26.322 13.765a31.862 31.862 0 0 0 18.21-5.709C449.091 377.953 480 318.938 480 256zm-96 0c0-33.717-17.186-64.35-45.972-81.944-15.079-9.214-34.775-4.463-43.992 10.616s-4.464 34.775 10.615 43.992C314.263 234.538 320 244.757 320 256a32.056 32.056 0 0 1-13.802 26.332c-14.524 10.069-18.136 30.006-8.067 44.53 10.07 14.525 30.008 18.136 44.53 8.067C368.546 316.983 384 287.478 384 256z"/></svg></button>'+"</span>"+'<span class="apbp-horizontal-volume-slider" tabindex="0">'+'<span class="apbp-offscreen">'+n.options.allyVolumeControlText+"</span>"+'<div class="apbp-horizontal-volume-total"></div>'+'<div class="apbp-horizontal-volume-current"></div>'+'<div class="apbp-horizontal-volume-handle"></div>'+"</span>").appendTo(t):e('<span class="apbp-button apbp-volume-button apbp-mute">'+'<button type="button" aria-controls="'+n.id+'" title="'+n.options.muteText+'" aria-label="'+n.options.muteText+'"></button>'+'<span class="apbp-volume-slider" tabindex="0">'+'<span class="apbp-offscreen">'+n.options.allyVolumeControlText+"</span>"+'<div class="apbp-volume-total"></div>'+'<div class="apbp-volume-current"></div>'+'<div class="apbp-volume-handle"></div>'+"</span>"+"</span>").appendTo(t),r=n.container.find(".apbp-volume-slider, .apbp-horizontal-volume-slider"),p=n.container.find(".apbp-volume-total, .apbp-horizontal-volume-total"),d=n.container.find(".apbp-volume-current, .apbp-horizontal-volume-current"),c=n.container.find(".apbp-volume-handle, .apbp-horizontal-volume-handle"),u=function(e,a){if(!r.is(":visible")&&typeof a=="undefined"){r.show();u(e,true);r.hide();return}e=Math.max(0,e);e=Math.min(e,1);if(e===0){o.removeClass("apbp-mute").addClass("apbp-unmute");o.children("button").attr("title",mejs.i18n.t("Unmute")).attr("aria-label",mejs.i18n.t("Unmute"))}else{o.removeClass("apbp-unmute").addClass("apbp-mute");o.children("button").attr("title",mejs.i18n.t("Mute")).attr("aria-label",mejs.i18n.t("Mute"))}var t=p.position();if(l=="vertical"){var i=p.height(),s=i-i*e;c.css("top",Math.round(t.top+s-c.height()/2));d.height(i-s);d.css("top",t.top+s)}else{var n=p.width(),f=n*e;c.css("left",Math.round(t.left+f-c.width()/2));d.width(Math.round(f))}},f=function(e){var a=null,t=p.offset();if(l==="vertical"){var i=p.height(),n=e.pageY-t.top;a=(i-n)/i;if(t.top===0||t.left===0){return}}else{var o=p.width(),r=e.pageX-t.left;a=r/o}a=Math.max(0,a);a=Math.min(a,1);u(a);if(a===0){s.setMuted(true)}else{s.setMuted(false)}s.setVolume(a)},m=false,b=false;o.hover(function(){r.show();b=true},function(){b=false;if(!m&&l=="vertical"){r.hide()}});var h=function(e){var a=Math.floor(s.volume*100);r.attr({"aria-label":mejs.i18n.t("volumeSlider"),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":a,"aria-valuetext":a+"%",role:"slider",tabindex:0})};r.bind("mouseover",function(){b=true}).bind("mousedown",function(e){f(e);n.globalBind("mousemove.vol",function(e){f(e)});n.globalBind("mouseup.vol",function(){m=false;n.globalUnbind(".vol");if(!b&&l=="vertical"){r.hide()}});m=true;return false}).bind("keydown",function(e){var a=e.keyCode;var t=s.volume;switch(a){case 38:t+=.1;break;case 40:t=t-.1;break;default:return true}m=false;u(t);s.setVolume(t);return false}).bind("blur",function(){r.hide()});o.find("button").click(function(){s.setMuted(!s.muted)});o.find("button").bind("focus",function(){r.show()});e(s).on("volumechange",function(e){if(!m){if(s.muted){u(0);o.removeClass("apbp-mute").addClass("apbp-unmute")}else{u(s.volume);o.removeClass("apbp-unmute").addClass("apbp-mute")}}h(e)});if(a.options.startVolume===0){s.setMuted(true)}if(s.pluginType==="native"){s.setVolume(a.options.startVolume)}e(n.container).on("controlsresize",function(){u(s.volume)})},changePoster:function(e){var a=this;a.layers.find(".apbp-poster").css("background-image",'url("'+e+'")');a.layers.find(".apbp-poster").show()},changeSlides:function(a,t,i,s){this.layers.find(".apbp-images").empty();if(t){var n=[];var l=[];for(var o=0;o<t.length;o++){var r=t[o];if(r.length==2){var p=e.trim(mejs.Utility.convertSMPTEtoSeconds(r[0]));if(!p){continue}n[n.length]=e('<div class="apbp-slide-image" style="background-image: url(\''+r[1]+'\');" data-start="'+p+'" />');l[l.length]=p}}if(!this.options.stacking){for(var d=1;d<l.length;d++){n[d-1].attr("data-end",l[d])}}this.layers.find(".apbp-images").append(n)}},updateCurrent:function(){if(this.media.duration>0&&this.media.currentTime>=0){this.controls.find(".apbp-timestamp-current").text(mejs.Utility.secondsToTimeCode(this.media.currentTime,this.options));var e=this.media.currentTime/this.media.duration*100;var a=this.getLoadedPercent();this.controls.find(".apbp-progress-current").css("width",e+"%");this.controls.find(".apbp-progress-loaded").css("width",a+"%")}},updateSlides:function(a,t,i){var s=a.currentTime;if(s>.1){t.addClass("apbp-blackout")}else{t.removeClass("apbp-blackout")}var n=t.children();n.css("opacity",0);var l=n.filter(function(t,i){return e(i).data("start")<=a.currentTime&&s>0&&(!e(i).data("end")||e(i).data("end")>a.currentTime)});l.css("opacity",1)},getLoadedPercent:function(e){var a=this,t=e!==undefined?e.target:a.media,i=null;if(t&&t.buffered&&t.buffered.length>0&&t.buffered.end&&t.duration){i=t.buffered.end(t.buffered.length-1)/t.duration}else if(t&&t.bytesTotal!==undefined&&t.bytesTotal>0&&t.bufferedBytes!==undefined){i=t.bufferedBytes/t.bytesTotal}else if(e&&e.lengthComputable&&e.total!==0){i=e.loaded/e.total}return i*100},updateTotal:function(){if(this.media.duration>=0){this.controls.find(".apbp-timestamp-total").text(mejs.Utility.secondsToTimeCode(this.media.duration,this.options))}},buildplaylist:function(a,t,i,s){var n=this;var l=e('<div class="apbp-button apbp-playlist-plugin-button apbp-playlist-button '+(a.options.playlist?"apbp-hide-playlist":"apbp-show-playlist")+'">'+'<button type="button" aria-controls="'+a.id+'" title="'+a.options.playlistText+'"><i class="fa fa-list"></i></button>'+"</div>");l.appendTo(t).click(function(){n.togglePlaylistDisplay(a,i,s)});n.playlistToggle=n.controls.find(".apbp-playlist-button")},togglePlaylistDisplay:function(a,t,i,s){var n=this;if(!!s){a.options.playlist=s==="show"?true:false}else{a.options.playlist=!a.options.playlist}e(i).trigger("mep-playlisttoggle",[a.options.playlist]);if(a.options.playlist){t.children(".apbp-playlist").fadeIn();n.playlistToggle.removeClass("apbp-show-playlist").addClass("apbp-hide-playlist")}else{t.children(".apbp-playlist").fadeOut();n.playlistToggle.removeClass("apbp-hide-playlist").addClass("apbp-show-playlist")}},genPlaylist:function(a,t,i,s){var n=this,l=e('<div class="apbp-playlist apbp-layer">'+'<ul class="apbp"></ul>'+"</div>").appendTo(i);if(!!e(s).data("showplaylist")){a.options.playlist=true;e("#"+a.id).find(".apbp-overlay-play").hide()}if(!a.options.playlist){l.hide()}var o=function(e){var a=e.split("/");if(a.length>0){return decodeURIComponent(a[a.length-1])}else{return""}};var r=[],p,d="";e("#"+a.id).find(".apbp-mediaelement source").each(function(){if(e(this).parent()[0]&&e(this).parent()[0].canPlayType){p=e(this).parent()[0].canPlayType(this.type)}else if(e(this).parent()[0]&&e(this).parent()[0].player&&e(this).parent()[0].player.media&&e(this).parent()[0].player.media.canPlayType){p=e(this).parent()[0].player.media.canPlayType(this.type)}else{console.error("Cannot determine if we can play this media (no canPlayType()) on"+e(this).toString())}if(!d&&(p==="maybe"||p==="probably")){d=this.type}if(!!d&&this.type===d){if(e.trim(this.src)!==""){var a={};a.source=e.trim(this.src);if(e.trim(this.title)!==""){a.name=e.trim(this.title)}else{a.name=o(a.source)}a.poster=e(this).data("poster");a.slides=e(this).data("slides");a.slidesinline=e(this).data("slides-inline");a.slideslang=e(this).data("slides-lang");r.push(a)}}});for(var c in r){var u=e('<li data-url="'+r[c].source+'" data-poster="'+r[c].poster+(!r[c].slides?"":'" data-slides="'+r[c].slides)+(!r[c].slideslang?"":'" data-slides-lang="'+r[c].slideslang)+'" title="'+r[c].name+'"><span>'+r[c].name+"</span></li>");u.data("slides-inline",r[c].slidesinline);i.find(".apbp-playlist > ul").append(u);if(e(a.media).hasClass("mep-slider")){u.css({"background-image":'url("'+u.data("poster")+'")'})}}i.find("li:first").addClass("current played");var f=i.find("li:first").first();a.changePoster(f.data("poster"));a.changeSlides(f.data("slides"),f.data("slides-inline"),f.data("slides-lang"),f.data("poster"));a.container.trigger("trackUpdate",[0,r.length]);i.find(".apbp-playlist > ul li").click(function(){if(!e(this).hasClass("current")){e(this).addClass("played");a.playTrack(e(this))}else{if(!a.media.paused){a.pause()}else{a.play()}}});e(s).on("ended",function(e){clearTimeout(e.target.finishedBackup);a.playNextTrack()});e(s).on("timeupdate",function(e){var t=e.target.duration-e.target.currentTime;if((t<=.1||t==NaN)&&!e.target.finishedDebounce){e.target.finishedDebounce=true;e.target.finishedBackup=setTimeout(function(){a.playNextTrack();e.target.finishedDebounce=false},500)}});e(s).on("playing",function(){a.container.removeClass("mep-paused").addClass("mep-playing");if(a.isVideo){n.togglePlaylistDisplay(a,i,s,"hide")}});e(s).on("play",function(){if(!a.isVideo){i.find(".apbp-poster").show()}},false);e(s).on("pause",function(){a.container.removeClass("mep-playing").addClass("mep-paused")})},buildplaypause:function(a,t,i,s){var n=this,l=n.options,o=e('<span class="apbp-button apbp-playpause apbp-playpause-play" >'+'<button type="button" aria-controls="'+n.id+'" title="'+l.playText+'" aria-label="'+l.playText+'">'+'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path class="play" d="M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"/><path class="pause" d="M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"/>'+"</button>"+"</span>").appendTo(t).click(function(e){e.preventDefault();if(s.paused){s.play()}else{s.pause()}return false}),r=o.find("button");function p(e){if("play"===e){o.removeClass("apbp-playpause-play").addClass("apbp-playpause-pause");r.attr({title:l.pauseText,"aria-label":l.pauseText})}else{o.removeClass("apbp-playpause-pause").addClass("apbp-playpause-play");r.attr({title:l.playText,"aria-label":l.playText})}}p("pse");e(s).on("play",function(){p("play")});e(s).on("playing",function(){p("play")});e(s).on("pause",function(){p("pse")});e(s).on("paused",function(){p("pse")})},nexttracksvg:function(e,a){var t="";if(a){t='transform="rotate(180,224,256)"'}return'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path '+t+' d="M 41.14804,498.27885 V 13.721154 c 0,-7.5426429 6.171254,-13.71389652 13.713897,-13.71389652 h 54.855583 c 7.54265,0 13.7139,6.17125362 13.7139,13.71389652 V 215.31544 L 346.85366,8.4641606 c 23.54219,-19.5423036 59.9983,-3.1999093 59.9983,28.1134884 V 475.42235 c 0,31.3134 -36.45611,47.65579 -59.9983,28.11349 L 123.43142,297.94167 v 200.33718 c 0,7.54264 -6.17125,13.71389 -13.7139,13.71389 H 54.861937 c -7.542643,0 -13.713897,-6.17125 -13.713897,-13.71389 z"/></svg>'},buildprevtrack:function(a,t,i,s){var n=this;var l=e('<span class="apbp-button apbp-previous">'+'<button type="button" aria-controls="'+a.id+'" title="'+a.options.prevText+'">'+a.nexttracksvg(false)+"</button>"+"</span>");l.appendTo(t).click(function(){e(s).trigger("apbp-playprevtrack");a.playPrevTrack()});e(a.container).on("trackUpdate",function(e,t,i){if(t<=0&&!a.loopPlaylist){l.addClass("apbp-disabled");l.find("button").prop("disabled",true)}else{l.removeClass("apbp-disabled");l.find("button").prop("disabled",false)}});n.prevTrack=n.controls.find(".apbp-prevtrack-button")},prevTrackClick:function(){var e=this;e.prevTrack.trigger("click")},buildnexttrack:function(a,t,i,s){var n=this;var l=e('<div class="apbp-button apbp-next">'+'<button type="button" aria-controls="'+a.id+'" title="'+a.options.nextText+'">'+a.nexttracksvg(true,true)+"</button>"+"</div>");l.appendTo(t).click(function(){e(s).trigger("apbp-playnexttrack");a.playNextTrack()});a.container.on("trackUpdate",function(e,t,i){if(t>=i-1&&!a.loopPlaylist){l.addClass("apbp-disabled");l.find("button").prop("disabled",true)}else{l.removeClass("apbp-disabled");l.find("button").prop("disabled",false)}});n.nextTrack=n.controls.find(".apbp-nexttrack-button")},nextTrackClick:function(){var e=this;e.nextTrack.trigger("click")},playNextTrack:function(){var e=this,a;var t=e.layers.find(".apbp-playlist > ul > li");var i=t.filter(".current");var s=t.not(".played");if(s.length<1){i.removeClass("played").siblings().removeClass("played");s=t.not(".current")}var n=false;a=i.next();if(a.length<1&&e.options.loopPlaylist){a=i.siblings().first();n=true}e.options.loop=false;if(a.length==1){a.addClass("played");e.playTrack(a)}},playPrevTrack:function(){var e=this,a;var t=e.layers.find(".apbp-playlist > ul > li");var i=t.filter(".current");var s=t.filter(".played").not(".current");if(s.length<1){i.removeClass("played");s=t.not(".current")}a=i.prev();if(a.length<1&&e.options.loopPlaylist){a=i.siblings().last()}if(a.length==1){i.removeClass("played");this.playTrack(a)}},playTrack:function(e){var a=this;try{a.media.pause()}catch(s){console.log(s)}a.media.setSrc(e.data("url"));if(!a.media.isLoaded){a.media.load()}a.changePoster(e.data("poster"));a.changeSlides(e.data("slides"),e.data("slides-inline"),e.data("slides-lang"),e.data("poster"));a.media.play();e.addClass("current").siblings().removeClass("current");var t=e.parent().children().length,i=e.index();a.container.trigger("trackUpdate",[i,t])},apbpReady:function(a,t){var i=this,s=mejs.MediaFeatures,n=t.getAttribute("autoplay"),l=!(typeof n=="undefined"||n===null||n==="false"),o,r;if(i.created){return}else{i.created=true}i.media=a;i.domNode=t;i.updateCurrent();i.updateTotal();i.updateSlides(i.media,i.layers.find(".apbp-images"),0);e(i.media).on("loadedmetadata",function(e){if(i.updateCurrent){i.updateCurrent()}if(i.updateTotal){i.updateTotal()}i.updateSlides(i.media,i.layers.find(".apbp-images"),e.currentTime)});e(i.media).on("loadeddata",function(e){if(i.updateCurrent){i.updateCurrent()}if(i.updateTotal){i.updateTotal()}});var p=null;e(i.media).on("timeupdate",function(){if(p!==this.duration){this.player.updateCurrent()}})},buildaudiofullscreen:function(a,t,i,s){var n=this;if(mejs.MediaFeatures.hasTrueNativeFullScreen){var l=function(e){if(screenfull.isFullscreen){a.container.addClass("apbp-fullscreen");a.isFullScreen=true}else{a.container.removeClass("apbp-fullscreen");a.isFullScreen=false}a.calculatePlayerHeight(a.layers)};a.globalBind(mejs.MediaFeatures.fullScreenEventName,l);e(window.document).on("fullscreenchange",l)}else{var l=function(e){if(screenfull.isFullscreen){if(screenfull.enabled){}else{a.container.addClass("apbp-fakefullscreen")}a.container.addClass("apbp-fullscreen");a.isFullScreen=true}else{if(screenfull.enabled){}else{a.container.removeClass("apbp-fakefullscreen")}a.container.removeClass("apbp-fullscreen");a.isFullScreen=false}a.calculatePlayerHeight(a.layers)};a.globalBind(mejs.MediaFeatures.fullScreenEventName,l)}n.fullscreenBtn=e('<span class="apbp-button apbp-fullscreen-expandcontract">'+'<button type="button" aria-controls="'+n.id+'" class="compress" title="'+n.options.fullscreenTextExit+'" aria-label="'+n.options.fullscreenTextExit+'">'+'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 32 448 448"><path class="compress" d="M436 192H312c-13.3 0-24-10.7-24-24V44c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v84h84c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm-276-24V44c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v84H12c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h124c13.3 0 24-10.7 24-24zm0 300V344c0-13.3-10.7-24-24-24H12c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h84v84c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-84h84c6.6 0 12-5.4 12-12v-40c0-6.6-5.4-12-12-12H312c-13.3 0-24 10.7-24 24v124c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12z"/></svg>'+"</button>"+'<button type="button" aria-controls="'+n.id+'" class="expand" title="'+n.options.fullscreenText+'" aria-label="'+n.options.fullscreenText+'">'+'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 32 448 448"><path class="expand" d="M0 180V56c0-13.3 10.7-24 24-24h124c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H64v84c0 6.6-5.4 12-12 12H12c-6.6 0-12-5.4-12-12zM288 44v40c0 6.6 5.4 12 12 12h84v84c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12V56c0-13.3-10.7-24-24-24H300c-6.6 0-12 5.4-12 12zm148 276h-40c-6.6 0-12 5.4-12 12v84h-84c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h124c13.3 0 24-10.7 24-24V332c0-6.6-5.4-12-12-12zM160 468v-40c0-6.6-5.4-12-12-12H64v-84c0-6.6-5.4-12-12-12H12c-6.6 0-12 5.4-12 12v124c0 13.3 10.7 24 24 24h124c6.6 0 12-5.4 12-12z"/></svg>'+"</button>"+"</span>");var o=false;console.log(a.options);console.log(a.options.features);if(a.options&&a.options.features){for(var r=0;r<a.options.features.length;r++){console.log(a.options.features[r]);if(a.options.features[r]=="fullscreen"){o=true}}}if(o){n.fullscreenBtn.appendTo(t)}var p=function(e){if(a.isFullScreen){if(screenfull.enabled){screenfull.exit()}else{a.container.removeClass("apbp-fakefullscreen")}a.container.removeClass("apbp-fullscreen");a.isFullScreen=false}else{if(screenfull.enabled){screenfull.request(a.container[0])}else{a.container.addClass("apbp-fakefullscreen")}a.container.addClass("apbp-fullscreen");a.isFullScreen=true}a.calculatePlayerHeight(a.layers)};n.fullscreenBtn.on("click",p)},buildprogressbar:function(e,a,t){var i=this,s=a.find(".apbp-progress"),n=a.find(".apbp-progress-loaded"),l=a.find(".apbp-progress-current"),o=a.find(".apbp-time-float"),r=a.find(".apbp-time-float-current");var p=function(a){var i=s.offset(),n=s.width(),l=0,p=0,c=0,u;if(a.originalEvent&&a.originalEvent.changedTouches){u=a.originalEvent.changedTouches[0].pageX}else if(a.changedTouches){u=a.changedTouches[0].pageX}else{u=a.pageX}if(t.duration){if(u<i.left){u=i.left}else if(u>n+i.left){u=n+i.left}c=u-i.left;l=c/n;p=l<=.02?0:l*t.duration;if(d&&p!==t.currentTime){t.setCurrentTime(p)}if(!mejs.MediaFeatures.hasTouch){console.log("Width: ",o.width());o.css("left",c-o.width()/2);r.html(mejs.Utility.secondsToTimeCode(p,e.options));o.show()}}},d=false,c=false,u=0,f=false,m=e.options.autoRewind;s.bind("mousedown touchstart",function(e){if(e.which===1||e.which===0){d=true;p(e);i.globalBind("mousemove.dur touchmove.dur",function(e){p(e)});i.globalBind("mouseup.dur touchend.dur",function(e){d=false;o.hide();i.globalUnbind(".dur")})}}).bind("mouseenter",function(e){c=true;i.globalBind("mousemove.dur",function(e){p(e)});if(!mejs.MediaFeatures.hasTouch){o.show()}}).bind("mouseleave",function(e){c=false;if(!d){i.globalUnbind(".dur");o.hide()}})},modcontrollayer:function(a,t){var i=this;t.css("opacity",0);var s=function o(e){i.resetControlsTimeout(i.controls);i.resetControlLayerTimeout(t)};var n="mousemove";var l="click touchend";if(i.options.handleFastclick){n="mousemove click";l="click"}t.find(".apbp-control-overlay-left").on(n,s);t.find(".apbp-control-overlay-right").on(n,s);t.find(".apbp-control-overlay-center").on(n,s);t.find(".apbp-control-overlay-left span").on(l,function r(e){var s=i.layers.find(".apbp-playlist > ul > li");var n=s.filter(".current");var l=n.index();if(i.controlsLayerVisible){if(l>0&&!a.loopPlaylist){i.playPrevTrack()}}else{i.controlsLayerVisible=true}i.resetControlsTimeout(i.controls);i.resetControlLayerTimeout(t);e.preventDefault()});t.find(".apbp-control-overlay-right span").on(l,function p(e){var s=i.layers.find(".apbp-playlist > ul > li");var n=s.filter(".current");var l=s.length;var o=n.index();if(i.controlsLayerVisible){if(o<l-1&&!a.loopPlaylist){i.playNextTrack()}}else{i.controlsLayerVisible=true}i.resetControlsTimeout(i.controls);i.resetControlLayerTimeout(t);e.preventDefault()});t.find(".apbp-control-overlay-center span").on(l,function d(e){if(i.controlsLayerVisible){if(i.media.paused){i.media.play()}else{i.media.pause()}}else{i.controlsLayerVisible=true}i.resetControlsTimeout(i.controls);i.resetControlLayerTimeout(t);e.preventDefault()});e(a.container).on("trackUpdate",function(e,i,s){if(i<=0&&!a.loopPlaylist){t.find(".apbp-control-overlay-left").addClass("apbp-disabled")}else{t.find(".apbp-control-overlay-left").removeClass("apbp-disabled")}if(i>=s-1&&!a.loopPlaylist){t.find(".apbp-control-overlay-right").addClass("apbp-disabled")}else{t.find(".apbp-control-overlay-right").removeClass("apbp-disabled")}})},resetControlLayerTimeout:function(e){if(typeof this.controlsLayerTimeout==="number"){window.clearTimeout(this.controlsLayerTimeout);delete this.controlsLayerTimeout;this.controlsLayerTimeout=null}e.css("opacity",1);var a=this;a.controlsLayerVisible=true;this.controlsLayerTimeout=window.setTimeout(function(e){return function(){e.css("opacity",0);a.controlsLayerVisible=false}}(e),2e3)},resetControlsTimeout:function(e){var a=this;if(typeof this.controlsTimeout==="number"){window.clearTimeout(this.controlsTimeout);delete this.controlsTimeout;this.controlsTimeout=null}e.addClass("apbp-vanishing-visible");a.controlsAreVisible=true;var t=function i(){a.controls.removeClass("apbp-vanishing-visible");a.controlsAreVisible=false};this.controlsTimeout=window.setTimeout(t,2e3)}};(function(){var a=/^((after|before)print|(before)?unload|hashchange|message|o(ff|n)line|page(hide|show)|popstate|resize|storage)\b/;function t(t,i){var s={d:[],w:[]};e.each((t||"").split(" "),function(e,t){var n=t+"."+i;if(n.indexOf(".")===0){s.d.push(n);s.w.push(n)}else{s[a.test(t)?"w":"d"].push(n)}});s.d=s.d.join(" ");s.w=s.w.join(" ");return s}apbp.audioPicturebookPlayer.prototype.globalBind=function(a,i,s){var n=this;a=t(a,n.id);if(a.d)e(document).bind(a.d,i,s);if(a.w)e(window).bind(a.w,i,s)};apbp.audioPicturebookPlayer.prototype.globalUnbind=function(a,i){var s=this;a=t(a,s.id);if(a.d)e(document).unbind(a.d,i);if(a.w)e(window).unbind(a.w,i)}})();if(typeof e!="undefined"){e.fn.audiopicturebookplayer=function(a){if(a===false){this.each(function(){var a=e(this).data("audiopicturebookplayer");if(a){a.remove()}e(this).removeData("audiopicturebookplayer")})}else{this.each(function(){e(this).data("audiopicturebookplayer",new apbp.audioPicturebookPlayer(this,a))})}return this};e(document).ready(function(){e(".apbp-player").audiopicturebookplayer()})}window.MediaElementPlayer=mejs.MediaElementPlayer})(jQuery);